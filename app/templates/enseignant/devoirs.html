{% extends "base.html" %} {% block title %}{{ current_user.nom }} {{
current_user.prenom }} | DEFITECH{% endblock %} {% block content %}
<!-- Toast notifications -->
{% set js_messages = get_flashed_messages(with_categories=true) %}
<!-- <div
  id="toast-container"
  class="fixed top-4 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-xs"
></div>
<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.4s;
    transition: opacity 0.4s;
  }
</style>
<script>
  document.addEventListener('DOMContentLoaded', function () {
      const messages = {{ js_messages| tojson | safe
  }};
  const colors = {
      success: 'bg-green-500 text-white',
      error: 'bg-red-500 text-white',
      warning: 'bg-yellow-400 text-gray-900',
      info: 'bg-blue-500 text-white',
  };
  const container = document.getElementById('toast-container');
  messages.forEach((msg, i) => {
      const toast = document.createElement('div');
      toast.className = `flex items-center justify-between px-4 py-3 rounded shadow mb-2 animate-fade-in ${colors[msg[0]] || colors.info}`;
      toast.style.opacity = 0;
      toast.innerHTML = `
      <span class="flex-1 pr-2">${msg[1]}</span>
      <button class="ml-2 text-xl font-bold focus:outline-none" aria-label="Fermer">&times;</button>
    `;
      container.appendChild(toast);
      setTimeout(() => { toast.style.opacity = 1; }, 100);
      // Fermeture manuelle
      toast.querySelector('button').onclick = () => {
          toast.style.opacity = 0;
          setTimeout(() => toast.remove(), 400);
      };
      // Fermeture auto
      setTimeout(() => {
          toast.style.opacity = 0;
          setTimeout(() => toast.remove(), 400);
      }, 4000 + i * 200);
  });
  });
</script> -->

<div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <h1 class="text-2xl font-bold mb-6">
    Envoyer un devoir, exercice, examen ou communiqué
  </h1>
  <form method="POST" enctype="multipart/form-data" class="bg-white rounded shadow p-6 space-y-4">
    <div>
      <label class="block text-sm font-medium text-gray-700">Type</label>
      <select name="type" required class="border rounded px-2 py-1 w-full">
        <option value="devoir">Devoir</option>
        <option value="exercice">Exercice</option>
        <option value="examen">Examen</option>
        <option value="communiqué">Communiqué</option>
      </select>
    </div>
    <div class="flex gap-4">
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700">Filière</label>
        <select name="filiere" required class="border rounded px-2 py-1 w-full">
          {% for f in filieres %}
          <option value="{{ f }}">{{ f }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700">Année</label>
        <select name="annee" required class="border rounded px-2 py-1 w-full">
          {% for a in annees %}
          <option value="{{ a }}">{{ a }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Titre</label>
      <input type="text" name="titre" required class="border rounded px-2 py-1 w-full" />
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Description</label>
      <textarea name="description" required class="border rounded px-2 py-1 w-full" rows="3"></textarea>
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Date limite (optionnel)</label>
      <input type="date" name="date_limite" class="border rounded px-2 py-1 w-full" />
    </div>
    <div>
      <label class="block text-sm font-medium text-gray-700">Fichier à envoyer (pdf, docx, xlsx, jpg, png, mp4,
        etc.)</label>
      <input type="file" name="fichier" accept=".pdf,.docx,.xlsx,.jpg,.jpeg,.png,.ico,.avif,.mp4,.avi,.mov"
        class="border rounded px-2 py-1 w-full" />
    </div>
    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded">
      Envoyer
    </button>
  </form>
</div>
{% endblock %}