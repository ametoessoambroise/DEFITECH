{% extends "base.html" %}

{% block title %}Communauté - {{ filiere.nom if filiere }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex flex-col md:flex-row gap-6">
        <!-- Sidebar -->
        <div class="w-full md:w-1/4 lg:w-1/5">
            <div class="bg-white text-gray-500 rounded-lg shadow-md p-4 mb-6">
                <h2 class="text-xl font-bold mb-4">Filières</h2>
                <ul class="space-y-2">
                    {% for f in filieres %}
                    <li>
                        <a href="{{ url_for('community.filiale', filiere_id=f.id) }}"
                            class="block px-3 py-2 rounded hover:bg-gray-100 {% if filiere and f.id == filiere.id %}bg-blue-50 text-blue-600 font-medium{% endif %}">
                            {{ f.nom }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>

                {% if current_user.is_authenticated and current_user.role == 'admin' %}
                <div class="mt-6 pt-4 border-t">
                    <a href="{{ url_for('community.manage_admins') }}"
                        class="block text-center bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors">
                        Gérer les administrateurs
                    </a>
                </div>
                {% endif %}
            </div>

            {% if filiere %}
            <div class="bg-white rounded-lg shadow-md p-4">
                <h3 class="font-semibold mb-3 text-gray-600">À propos de {{ filiere.nom }}</h3>
                <p class="text-gray-600 text-sm">{{ filiere.description or "Aucune description disponible." }}</p>

                {% if filiere.admins %}
                <div class="mt-4 pt-3 border-t">
                    <h4 class="text-sm font-medium text-gray-700 mb-2">Administrateurs</h4>
                    <ul class="space-y-1">
                        {% for admin in filiere.admins %}
                        <li class="flex items-center space-x-2 text-sm">
                            <span class="w-2 h-2 rounded-full bg-green-500"></span>
                            <span>{{ admin.enseignant.user.nom }} {{ admin.enseignant.user.prenom }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
                <a href="{{ url_for('community.filiale', filiere_id=filiere.id) }}"
                    class="inline-flex items-center text-blue-600 hover:text-blue-800 bg-white mt-4 p-2 rounded-lg shadow-lg">
                    Retour aux discussions
                    <i class="fas fa-comments mr-2"></i>
                </a>
            {% endif %}
        </div>

        <!-- Main Content -->
        <div class="w-full md:w-3/4 lg:w-4/5">
            {% block community_content %}
            {% endblock %}
        </div>
    </div>
</div>
{% endblock %}