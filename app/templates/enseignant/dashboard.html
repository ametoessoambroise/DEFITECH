{% extends "base.html" %} {% block title %}{{ current_user.nom }} {{
current_user.prenom }} - DEFITECH{% endblock %} {% block content %}
<div class="min-h-screen bg-gray-50 uppercase-none">
  <!-- Header avec gradient -->
  <div
    class="bg-gradient-to-r from-purple-700 to-indigo-900 text-white shadow-lg"
  >
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div
        class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6"
      >
        <div class="flex items-start gap-4">
          <div
            class="hidden sm:flex w-16 h-16 bg-white/10 backdrop-blur-sm rounded-2xl items-center justify-center flex-shrink-0 border border-white/20 shadow-xl"
          >
            <i class="fas fa-chalkboard-teacher text-3xl"></i>
          </div>
          <div>
            <h1 class="text-3xl md:text-4xl font-bold mb-2">
              Bienvenue, {{ current_user.prenom }}
            </h1>
            <p class="text-purple-100 text-base md:text-lg">
              Prêt pour une nouvelle journée d'enseignement ?
            </p>
          </div>
        </div>

        <div class="flex flex-wrap items-center gap-3">
          <a
            href="{{ url_for('teachers.emploi_temps') }}"
            class="inline-flex items-center px-4 py-2.5 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white font-medium hover:bg-white/20 transition-all shadow-lg active:scale-95"
          >
            <i class="fas fa-clock mr-2"></i>
            <span>Mon planning</span>
          </a>
          <a
            href="{{ url_for('chat.user_chat') }}"
            class="inline-flex items-center px-4 py-2.5 bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl text-white font-medium hover:bg-white/20 transition-all shadow-lg active:scale-95"
          >
            <i class="fas fa-comments mr-2"></i>
            <span>Assistance</span>
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-6 mb-8">
    <!-- Statistiques -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
      <div
        class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 hover:shadow-md transition-shadow"
      >
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm font-medium text-gray-600">Matières</p>
            <p class="text-3xl font-bold text-gray-900 mt-1">
              {{ matieres|length }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-purple-50 rounded-xl flex items-center justify-center"
          >
            <i class="fas fa-book text-purple-600 text-xl"></i>
          </div>
        </div>
      </div>

      <div
        class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 hover:shadow-md transition-shadow"
      >
        <div class="flex items-center justify-between">
          <div>
            <p class="text-sm font-medium text-gray-600">Étudiants</p>
            <p class="text-3xl font-bold text-gray-900 mt-1">
              {{ etudiants_count }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-green-50 rounded-xl flex items-center justify-center"
          >
            <i class="fas fa-user-graduate text-green-600 text-xl"></i>
          </div>
        </div>
      </div>

      <a
        href="{{ url_for('teachers.cours_aujourdhui') }}"
        class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 hover:bg-blue-50/50 hover:shadow-md transition-all group"
      >
        <div class="flex items-center justify-between">
          <div>
            <p
              class="text-sm font-medium text-gray-600 group-hover:text-blue-700 transition-colors"
            >
              Cours du jour
            </p>
            <p class="text-3xl font-bold text-gray-900 mt-1">
              {{ cours_aujourdhui_count }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center group-hover:bg-blue-100 transition-colors"
          >
            <i class="fas fa-calendar-check text-blue-600 text-xl"></i>
          </div>
        </div>
      </a>

      <a
        href="{{ url_for('teachers.devoirs_a_corriger') }}"
        class="bg-white rounded-xl shadow-sm border border-gray-100 p-5 hover:bg-yellow-50/50 hover:shadow-md transition-all group"
      >
        <div class="flex items-center justify-between">
          <div>
            <p
              class="text-sm font-medium text-gray-600 group-hover:text-yellow-700 transition-colors"
            >
              À corriger
            </p>
            <p class="text-3xl font-bold text-gray-900 mt-1">
              {{ devoirs_a_corriger }}
            </p>
          </div>
          <div
            class="w-12 h-12 bg-yellow-50 rounded-xl flex items-center justify-center group-hover:bg-yellow-100 transition-colors"
          >
            <i class="fas fa-tasks text-yellow-600 text-xl"></i>
          </div>
        </div>
      </a>
    </div>
  </div>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
    <!-- Actions rapides -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
      <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">
          Actions rapides
        </h3>
        <div class="space-y-3">
          <a
            href="{{ url_for('teachers.notes') }}"
            class="flex items-center p-3 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors"
          >
            <i class="fas fa-star text-purple-600 mr-3"></i>
            <span class="text-purple-900">Gérer les notes</span>
          </a>
          <a
            href="{{ url_for('teachers.devoirs') }}"
            class="flex items-center p-3 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors"
          >
            <i class="fas fa-star text-purple-600 mr-3"></i>
            <span class="text-purple-900">Assigner un devoir</span>
          </a>

          <a
            href="{{ url_for('teachers.manage_etudiants') }}"
            class="flex items-center p-3 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors"
          >
            <i class="fas fa-user-graduate text-purple-600 mr-3"></i>
            <span class="text-purple-900">Gestion des étudiants</span>
          </a>
          <a
            href="{{ url_for('community.index') }}"
            class="flex items-center p-3 bg-rose-50 rounded-lg hover:bg-rose-100 transition-colors"
          >
            <i class="fas fa-users text-rose-600 mr-3"></i>
            <span class="text-rose-900">Communauté</span>
          </a>
          <!-- <a href="{{ url_for('teachers.presence') }}"
          class="flex items-center p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors">
          <i class="fas fa-calendar-check text-green-600 mr-3"></i>
          <span class="text-green-900">Présence/Absence</span>
        </a> -->
          <a
            href="{{ url_for('teachers.emploi_temps') }}"
            class="flex items-center p-3 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors"
          >
            <i class="fas fa-clock text-blue-600 mr-3"></i>
            <span class="text-blue-900">Emploi du temps</span>
          </a>
          <a
            href="{{ url_for('resources.index') }}"
            class="flex items-center p-3 bg-green-50 rounded-lg hover:bg-green-100 transition-colors"
          >
            <i class="fas fa-book text-green-600 mr-3"></i>
            <span class="text-green-900">Ressources numériques</span>
          </a>
          <a
            href="{{ url_for('resources.my_resources') }}"
            class="flex items-center p-3 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-colors"
          >
            <i class="fas fa-folder text-indigo-600 mr-3"></i>
            <span class="text-indigo-900">Mes ressources</span>
          </a>
          <a
            href="{{ url_for('academic_history.search_history') }}"
            class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"
          >
            <i class="fas fa-history text-gray-600 mr-3"></i>
            <span class="text-gray-900">Archives Académiques</span>
          </a>
        </div>
      </div>

      <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">
          Matières enseignées
        </h3>
        {% if matieres %}
        <div class="space-y-3">
          {% for matiere in matieres %}
          <div class="p-3 bg-gray-50 rounded-lg">
            <div class="flex items-center justify-between">
              <div>
                <p class="font-medium text-gray-900">{{ matiere.nom }}</p>
                <p class="text-sm text-gray-600">
                  Filière: {{ matiere.filiere.nom }}
                </p>
              </div>
              <span
                class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800"
              >
                Actif
              </span>
            </div>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-8">
          <i class="fas fa-book text-4xl text-gray-300 mb-4"></i>
          <p class="text-gray-500">Aucune matière assignée</p>
        </div>
        {% endif %}
      </div>

      <div class="bg-white rounded-lg shadow p-6">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">
          Notifications récentes
        </h3>
        <div class="space-y-3">
          {% if notifications %} {% for notif in notifications %}
          <div
            class="p-3 rounded-lg {% if notif.type == 'success' %}bg-green-50 {% elif notif.type == 'warning' %}bg-yellow-50 {% elif notif.type == 'error' %}bg-red-50 {% else %}bg-blue-50{% endif %}"
          >
            <p
              class="text-sm font-medium {% if notif.type == 'success' %}text-green-900 {% elif notif.type == 'warning' %}text-yellow-900 {% elif notif.type == 'error' %}text-red-900 {% else %}text-blue-900{% endif %}"
            >
              {{ notif.message }}
            </p>
            <p
              class="text-xs {% if notif.type == 'success' %}text-green-600 {% elif notif.type == 'warning' %}text-yellow-600 {% elif notif.type == 'error' %}text-red-600 {% else %}text-blue-600{% endif %}"
            >
              {{ notif.date_created.strftime('%d/%m/%Y %H:%M') }}
            </p>
          </div>
          {% endfor %} {% else %}
          <div class="text-center py-8">
            <i class="fas fa-bell text-4xl text-gray-300 mb-4"></i>
            <p class="text-gray-500">Aucune notification récente</p>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    <!-- Emploi du temps du jour -->
    <div
      class="bg-white rounded-xl shadow-sm border border-gray-100 mb-8 overflow-hidden hover:shadow-md transition-shadow"
    >
      <div
        class="px-6 py-5 border-b border-gray-100 bg-gray-50/50 flex items-center justify-between"
      >
        <h3 class="text-lg font-bold text-gray-900 flex items-center gap-2">
          <i class="fas fa-calendar-day text-blue-600"></i>
          Emploi du temps - Aujourd'hui
        </h3>
        <a
          href="{{ url_for('teachers.emploi_temps') }}"
          class="text-xs font-semibold text-blue-600 hover:text-blue-800 uppercase tracking-wider"
          >Voir tout</a
        >
      </div>
      <div class="p-6">
        {% if cours_aujourdhui and cours_aujourdhui|length > 0 %}
        <div class="space-y-4">
          {% for cours in cours_aujourdhui %}
          <div
            class="flex items-center p-4 bg-blue-50/30 rounded-xl border border-blue-100 group hover:bg-blue-50 transition-colors"
          >
            <div
              class="w-16 h-16 bg-white rounded-xl shadow-sm border border-blue-100 flex flex-col items-center justify-center mr-6 shrink-0 group-hover:scale-105 transition-transform"
            >
              <span class="text-xs font-bold text-blue-600 uppercase"
                >{{ cours.heure_debut.strftime('%H:%M') }}</span
              >
              <div class="w-8 h-px bg-blue-100 my-1"></div>
              <span class="text-[10px] font-medium text-gray-400"
                >{{ cours.heure_fin.strftime('%H:%M') }}</span
              >
            </div>
            <div class="flex-grow">
              <h4 class="font-bold text-gray-900">{{ cours.matiere.nom }}</h4>
              <div class="flex items-center gap-4 mt-1">
                <span class="text-xs text-gray-600 flex items-center gap-1.5">
                  <i class="fas fa-door-open text-gray-400"></i>
                  {{ cours.salle }}
                </span>
                <span class="text-xs text-gray-600 flex items-center gap-1.5">
                  <i class="fas fa-users text-gray-400"></i>
                  {{ cours.filiere.nom }}
                </span>
              </div>
            </div>
            <div class="hidden sm:block">
              <span
                class="px-3 py-1 bg-green-100 text-green-700 rounded-full text-[10px] font-bold uppercase tracking-wider"
                >Confirmé</span
              >
            </div>
          </div>
          {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-12">
          <div
            class="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <i class="fas fa-calendar-day text-3xl text-gray-300"></i>
          </div>
          <p class="text-gray-500 font-medium">
            Aucun cours programmé aujourd'hui
          </p>
          <p class="text-gray-400 text-xs mt-1">
            Profitez de ce temps pour vos corrections ou préparations.
          </p>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.4s;
    transition: opacity 0.4s;
  }

  .bg-white {
    animation: fade-in 0.4s ease-out;
  }
</style>
{% endblock %}
