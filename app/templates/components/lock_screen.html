<!-- Lock Screen Overlay -->
<div
  id="appLockOverlay"
  class="fixed inset-0 z-[10000] bg-slate-900/95 backdrop-blur-xl flex flex-col items-center justify-center p-4 transition-opacity duration-300 hidden opacity-0 text-black"
>
  <div class="max-w-md w-full flex flex-col items-center gap-8">
    <!-- Header -->
    <div class="text-center">
      <div
        class="w-20 h-20 bg-blue-600 rounded-3xl flex items-center justify-center shadow-2xl shadow-blue-500/20 mx-auto mb-4 animate-bounce-slow"
      >
        <i class="fas fa-lock text-white text-3xl"></i>
      </div>
      <h2 class="text-2xl font-bold text-white mb-2">
        Application Verrouillée
      </h2>
      <p id="lockStatusMessage" class="text-slate-400 text-sm">
        Entrez votre code PIN pour continuer
      </p>
    </div>

    <!-- PIN Dots -->
    <div id="pinDots" class="flex gap-4">
      <div
        class="w-4 h-4 rounded-full border-2 border-slate-700 transition-all duration-200"
      ></div>
      <div
        class="w-4 h-4 rounded-full border-2 border-slate-700 transition-all duration-200"
      ></div>
      <div
        class="w-4 h-4 rounded-full border-2 border-slate-700 transition-all duration-200"
      ></div>
      <div
        class="w-4 h-4 rounded-full border-2 border-slate-700 transition-all duration-200"
      ></div>
      <div
        class="w-4 h-4 rounded-full border-2 border-slate-700 transition-all duration-200"
      ></div>
      <div
        class="w-4 h-4 rounded-full border-2 border-slate-700 transition-all duration-200"
      ></div>
    </div>

    <!-- Numeric Keypad -->
    <div
      id="keypadContainer"
      class="grid grid-cols-3 gap-4 w-full max-w-[300px]"
    >
      {% for i in range(1, 10) %}
      <button
        onclick="AppLock.appendDigit('{{ i }}')"
        class="h-16 rounded-2xl bg-white/5 border border-white/10 text-white text-2xl font-semibold hover:bg-white/10 active:scale-95 transition-all"
      >
        {{ i }}
      </button>
      {% endfor %}
      <button
        onclick="AppLock.useBiometrics()"
        id="biometricBtn"
        class="h-16 rounded-2xl bg-blue-600/10 border border-blue-600/20 text-blue-500 text-xl flex items-center justify-center hover:bg-blue-600/20 active:scale-95 transition-all hidden"
      >
        <i class="fas fa-fingerprint"></i>
      </button>
      <button
        onclick="AppLock.appendDigit('0')"
        class="h-16 rounded-2xl bg-white/5 border border-white/10 text-white text-2xl font-semibold hover:bg-white/10 active:scale-95 transition-all"
      >
        0
      </button>
      <button
        onclick="AppLock.clearDigits()"
        class="h-16 rounded-2xl bg-red-600/10 border border-red-600/20 text-red-500 text-xl flex items-center justify-center hover:bg-red-600/20 active:scale-95 transition-all"
      >
        <i class="fas fa-backspace"></i>
      </button>

      <!-- Bouton de validation pour les PIN de 4 ou 5 chiffres -->
      <button
        id="validatePinBtn"
        onclick="AppLock.verifyPIN()"
        class="col-span-3 h-12 mt-2 rounded-xl bg-blue-600/20 border border-blue-600/30 text-blue-400 font-semibold hover:bg-blue-600/30 transition-all hidden"
      >
        Valider le PIN
      </button>
    </div>

    <!-- Password Fallback (Hidden by default) -->
    <div
      id="passwordFallbackForm"
      class="hidden w-full max-w-[300px] flex flex-col gap-4"
    >
      <input
        type="password"
        id="fallbackPasswordInput"
        class="w-full h-14 bg-white/5 border border-white/10 rounded-2xl px-4 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-blue-500/50"
        placeholder="Mot de passe de la plateforme"
      />
      <div class="flex gap-3">
        <button
          onclick="AppLock.hidePasswordForm()"
          class="flex-1 h-12 rounded-xl bg-white/5 text-slate-400 font-medium hover:bg-white/10 transition-all"
        >
          Retour
        </button>
        <button
          onclick="AppLock.verifyPassword()"
          class="flex-1 h-12 rounded-xl bg-blue-600 text-white font-semibold hover:bg-blue-700 shadow-lg shadow-blue-600/20 transition-all"
        >
          Déverrouiller
        </button>
      </div>
    </div>

    <!-- Footer Actions -->
    <div class="flex flex-col items-center gap-4">
      <button
        id="togglePasswordFormBtn"
        onclick="AppLock.showPasswordForm()"
        class="text-blue-500 hover:text-blue-400 text-sm font-medium transition-colors"
      >
        Essayer avec le mot de passe
      </button>
      <button
        onclick="AppLock.logout()"
        class="text-slate-500 hover:text-white text-xs transition-colors"
      >
        Se déconnecter
      </button>
    </div>
  </div>
</div>

<style>
  @keyframes bounce-slow {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-10px);
    }
  }
  .animate-bounce-slow {
    animation: bounce-slow 3s infinite ease-in-out;
  }
  .pin-dot-active {
    background-color: #2563eb !important;
    border-color: #2563eb !important;
    transform: scale(1.2);
  }
  .pin-shake {
    animation: shake 0.4s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
  }
  @keyframes shake {
    10%,
    90% {
      transform: translate3d(-1px, 0, 0);
    }
    20%,
    80% {
      transform: translate3d(2px, 0, 0);
    }
    30%,
    50%,
    70% {
      transform: translate3d(-4px, 0, 0);
    }
    40%,
    60% {
      transform: translate3d(4px, 0, 0);
    }
  }
</style>
